# 我的linux日常生活-分割硬碟

###### tags: `我的linux日常生活`

最近在工作上有一顆新的硬碟新增到主機上，順便紀錄一下處理步驟吧。

處理步驟如下：

1. 取得硬碟資訊，確認實際要格式化那一顆硬碟
2. 規劃硬碟分割格式
3. 執行分割
4. 新增要掛載的目標目錄
5. 掛載目錄

## 取得硬碟資訊

在分割硬碟之前記得先確認一下新增硬碟的詳細資訊，例如：硬碟容量大小等等。如果不知道可以下```df -h```記下哪些硬碟已經被使用了，之接下來檢查目前有哪些硬碟還沒有被掛載就可以知道目標的硬碟資訊。

這邊我們先用 ```fdisk -l```查詢要新增的硬碟是那一顆。

```shell
sudo fdisk -l
```

```

Disk /dev/nvme0n1: 238.49 GiB, 256060514304 bytes, 500118192 sectors
Disk model: ADATA SX6000LNP                         
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: D5C48C1D-1988-4CA1-A217-FF1BC085424D

Device           Start       End   Sectors  Size Type
/dev/nvme0n1p1    2048   1050623   1048576  512M EFI System
/dev/nvme0n1p2 1050624 500117503 499066880  238G Linux filesystem


Disk /dev/sda: 931.53 GiB, 1000204886016 bytes, 1953525168 sectors
Disk model: HGST HTS721010A9
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disklabel type: gpt
Disk identifier: 915708BA-0000-4BA0-9877-32977D4DB10F

Device     Start        End    Sectors   Size Type
/dev/sda1   2048 1953523711 1953521664 931.5G Linux filesystem


Disk /dev/sdb: 223.58 GiB, 240057409536 bytes, 468862128 sectors
Disk model: KINGSTON SA400S3
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: 6345E406-7411-44AF-5551-829E435CD0C8

```

這次我是新增的硬碟為```/dev/sdb```這一顆，接下來就是分割硬碟。

## 計劃分割表

分割硬碟目前有分```gdisk```與```fdisk```。

```gdisk```：是 GPT

```fdisk```：是 MBR

在實際應用上，GPT可以規劃2TB以上的硬碟

```shell
sudo gdisk /dev/sdb

# n -> 新增磁區
# p -> 邏輯磁區
# w -> 寫入分割表
```

## 執行分割

規劃完畢後，就是開始分割硬碟了。

```shell
sudo mkfs.ext4 /dev/sda
```

## 新增掛載目錄資料夾

分割完成之後，就是規劃這個硬碟要掛載到目錄哪裡。如果沒有，就得自己新增。

```
mkdir -p /home/pollochang/data
```

## 掛載

確認是那一個目錄之後就是透過```mount```掛載了。

```
sudo mount /dev/sda /home/pollochang/data
```

## 寫到fstab中

如果重新開機，你會發現之前掛載的硬碟消失了！不對！新的硬碟還須要新增到```/etc/fstab```這個目錄中

```shell
sudo vim /etc/fstab
```

新增的內容如下

```
...
/dev/disk/by-uuid/6345E406-7411-44AF-5551-829E435CD0C8 /home/pollochang/data auto nosuid,nodev,nofail,x-gvfs-show 0 0
...
```